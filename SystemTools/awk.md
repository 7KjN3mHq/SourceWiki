# AWK

## 一、awk 简介

最简单地说， AWK 是一种用于处理文本的编程语言工具。AWK 在很多方面类似于 shell 编程语言，尽管 AWK 具有完全属于其本身的语法。它的设计思想来源于 SNOBOL4 、sed 、Marc Rochkind 设计的有效性语言、语言工具 yacc 和 lex ，当然还从 C 语言中获取了一些优秀的思想。在最初创造 AWK 时，其目的是用于文本处理，并且这种语言的基础是，只要在输入数据中有模式匹配，就执行一系列指令。该实用工具扫描文件中的每一行，查找与命令行中所给定内容相匹配的模式。如果发现匹配内容，则进行下一个编程步骤。如果找不到匹配内容，则继续处理下一行。

## 二、空行、行号和计算

### 2.1 每行后面都添加一个空行

awk 程序都是由一系列的 "匹配模式 { 执行动作 }" 语句所组成。在每个 "匹配模式――执行动作" 语句中，模式和动作都是可以被省略的。如果匹配模式被省略，那么预定的动作将会对输入文件的每一行执行。

``` bash
awk '1; { print "" }'
等价于 # 如果动作被省略，那么默认就会执行{print }
awk '1 {print } { print "" }'   
等价于 # 动作只有在匹配模式值为真时执行，"1"永远为真
awk '{print } { print "" }'
```

### 2.2 添加空行的另外一种方法

awk 中每条 print 语句后都默认会输出一个 ORS 变量(Output Record Seprator，即输出行分隔符，默认为换行符)。第一个不带参数的 print 语句等同于 print $0，其中 $0 代表整行内容的变量。第二个 print 语句什么也不输出，但是鉴于 print 语句后都会被自动加上 ORS 变量，这句的作用就是输出一个新行，遇事每行后面加空行的目的达到了。

``` bash
awk ' BEGIN { ORS="\n\n" }; 1'
# BEGIN 是特殊的模式，后面所接的内容，会在文件被读入前执行。
# 这里对 ORS 变量进行重新定义，将一个换行符改成两个。"1"，等价于 {print }
```

### 2.3 在每一个非空的行后面添加空行

``` bash
awk 'NF {print $0 "\n"}'
```

NF（number of fields），即本行被分割成的字段的数目。当遇到空行，NF 值为0，后面的匹配动作就不会被执行，这条语句可以理解为 "如果这一行可以分割成任意大于0的部分，那么输出当前行以及一个换行符"。

### 2.4 在每行后添加两个空行

``` bash
awk '1; {print "\n"}'
等价于
awk '{print ; print "\n"}'
```

